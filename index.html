<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Quest - Master AI Prompt Engineering</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
    <script src="https://unpkg.com/splitting@1.0.6/dist/splitting.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/splitting@1.0.6/dist/splitting.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Vanta.js dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.dots.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.globe.min.js"></script>

    <!-- New CSS files -->
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/dark-theme-fixes.css">

    <style>
        :root {
            /* Core Palette */
            --primary: #4F46E5;
            --primary-dark: #4338CA;
            --primary-light: #818CF8;
            --secondary: #059669;
            --accent: #F59E0B;
            --danger: #EF4444;

            /* Semantic Colors */
            --bg-main: #0F0F1E;
            --bg-card: rgba(30, 41, 59, 0.95);
            --bg-card-hover: rgba(30, 41, 59, 1);

            --text-primary: #F9FAFB;
            --text-secondary: #D1D5DB;
            --text-muted: #9CA3AF;

            --border-light: rgba(75, 85, 99, 0.4);
            --border-focus: rgba(79, 70, 229, 0.6);
        }

        /* Light Theme Override Class */
        body.light-theme {
            --bg-main: #FEFBF3;
            --bg-card: rgba(255, 255, 255, 0.95);
            --bg-card-hover: #FFFFFF;

            --text-primary: #1F2937;
            --text-secondary: #4B5563;
            --text-muted: #6B7280;

            --border-light: rgba(229, 231, 235, 1);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-primary);
            position: relative;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }

        #vanta-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        /* Animated CSS background fallback */
        @keyframes moveGradient {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0F0F1E;
            overflow: hidden;
            z-index: 0;
        }

        .animated-bg::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 150%;
            height: 150%;
            background: conic-gradient(
                    from 0deg at 50% 50%,
                    rgba(79, 70, 229, 0.3) 0deg,
                    transparent 60deg,
                    rgba(5, 150, 105, 0.3) 120deg,
                    transparent 180deg,
                    rgba(245, 158, 11, 0.2) 240deg,
                    transparent 300deg,
                    rgba(79, 70, 229, 0.3) 360deg
            );
            animation: moveGradient 20s linear infinite;
        }

        .animated-bg::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, transparent 0%, rgba(15, 15, 30, 0.8) 70%);
        }

        .main-game-container {
            position: relative;
            z-index: 1;
        }

        /* Dark theme adjustments */
        nav {
            background: rgba(17, 24, 39, 0.98) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(75, 85, 99, 0.3);
        }

        .bg-white {
            background: rgba(30, 41, 59, 0.95) !important;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(75, 85, 99, 0.2);
        }

        .text-gray-900 {
            color: #F9FAFB !important;
        }

        .text-gray-700 {
            color: #E5E7EB !important;
        }

        .text-gray-600 {
            color: #D1D5DB !important;
        }

        .text-gray-500 {
            color: #9CA3AF !important;
        }

        .text-gray-400 {
            color: #6B7280 !important;
        }

        .bg-gray-50 {
            background: rgba(30, 41, 59, 0.6) !important;
            border: 1px solid rgba(75, 85, 99, 0.2);
        }

        .bg-gray-100 {
            background: rgba(30, 41, 59, 0.8) !important;
        }

        .bg-blue-50 {
            background: rgba(59, 130, 246, 0.15) !important;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .bg-amber-50 {
            background: rgba(245, 158, 11, 0.15) !important;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .bg-green-50 {
            background: rgba(16, 185, 129, 0.15) !important;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .bg-purple-50 {
            background: rgba(168, 85, 247, 0.15) !important;
            border: 1px solid rgba(168, 85, 247, 0.3);
        }

        .text-blue-900, .text-blue-800 {
            color: #93C5FD !important;
        }

        .text-amber-900, .text-amber-800 {
            color: #FCD34D !important;
        }

        .text-green-900, .text-green-800 {
            color: #6EE7B7 !important;
        }

        .text-purple-900, .text-purple-800 {
            color: #C4B5FD !important;
        }

        .border-gray-300 {
            border-color: rgba(75, 85, 99, 0.5) !important;
        }

        textarea, input {
            background: rgba(17, 24, 39, 0.9) !important;
            color: #F9FAFB !important;
            border-color: rgba(75, 85, 99, 0.5) !important;
        }

        textarea::placeholder, input::placeholder {
            color: #6B7280 !important;
        }

        textarea:focus, input:focus {
            border-color: var(--primary) !important;
            background: rgba(17, 24, 39, 0.95) !important;
            outline: none;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .font-display { font-family: 'Poppins', sans-serif; }

        .hero-bg {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.2) 0%, rgba(5, 150, 105, 0.2) 100%);
            min-height: 40vh;
            backdrop-filter: blur(5px);
        }

        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .gradient-text {
            background: linear-gradient(135deg, #818CF8 0%, #34D399 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Button colors for dark theme */
        .open-mini-games {
            background: rgba(147, 51, 234, 0.25) !important;
            color: #E9D5FF !important;
            border: 1px solid rgba(147, 51, 234, 0.4);
            font-weight: 600;
        }

        .open-mini-games:hover {
            background: rgba(147, 51, 234, 0.4) !important;
            border-color: rgba(147, 51, 234, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(147, 51, 234, 0.3);
        }

        .open-achievements {
            background: rgba(251, 191, 36, 0.25) !important;
            color: #FEF3C7 !important;
            border: 1px solid rgba(251, 191, 36, 0.4);
            font-weight: 600;
        }

        .open-achievements:hover {
            background: rgba(251, 191, 36, 0.4) !important;
            border-color: rgba(251, 191, 36, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
        }

        /* Navigation links */
        nav a {
            color: #D1D5DB !important;
            transition: color 0.2s;
        }

        nav a:hover {
            color: #F9FAFB !important;
        }

        /* Multiplayer button */
        .open-multiplayer {
            background: rgba(99, 102, 241, 0.25) !important;
            color: #E0E7FF !important;
            border: 1px solid rgba(99, 102, 241, 0.4) !important;
            font-weight: 600 !important;
        }

        .open-multiplayer:hover {
            background: rgba(99, 102, 241, 0.4) !important;
            border-color: rgba(99, 102, 241, 0.6) !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .open-multiplayer span {
            color: #E0E7FF !important;
        }

        /* Stats section dark theme */
        .stat-card {
            background: rgba(30, 41, 59, 0.9);
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid rgba(75, 85, 99, 0.4);
            transition: all 0.3s;
        }

        .stat-card:hover {
            background: rgba(30, 41, 59, 1);
            border-color: rgba(79, 70, 229, 0.5);
            transform: translateY(-2px);
        }

        .stat-card .text-gray-600 {
            color: #9CA3AF !important;
            font-weight: 500;
        }

        /* Challenge cards dark theme */
        .challenge-card {
            background: rgba(30, 41, 59, 0.95) !important;
            border: 1px solid rgba(75, 85, 99, 0.4);
            cursor: pointer;
        }

        .challenge-card:hover {
            background: rgba(30, 41, 59, 1) !important;
            border-color: rgba(79, 70, 229, 0.6);
            box-shadow: 0 8px 24px rgba(79, 70, 229, 0.2);
        }

        .challenge-card .select-challenge {
            cursor: pointer;
            transition: all 0.2s;
        }

        .challenge-card .select-challenge:hover {
            transform: scale(1.05);
        }

        .challenge-card .select-challenge:active {
            transform: scale(0.98);
        }

        .difficulty-easy { background: #10B981; color: white; }
        .difficulty-intermediate { background: #F59E0B; color: white; }
        .difficulty-advanced { background: #EF4444; color: white; }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: -400px;
            z-index: 1000;
            transition: right 0.3s ease-out;
        }

        .notification.show {
            right: 20px;
        }

        .progress-ring {
            transform: rotate(-90deg);
        }

        .challenge-card {
            position: relative;
            overflow: hidden;
        }

        .challenge-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .challenge-card:hover::before {
            left: 100%;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Button styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.875rem 1.75rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            text-align: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            cursor: pointer;
        }

        .btn-primary:hover {
            background: #4338CA;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(79, 70, 229, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: rgba(75, 85, 99, 0.3);
            color: #E5E7EB;
            border: 1px solid rgba(75, 85, 99, 0.5);
            cursor: pointer;
        }

        .btn-secondary:hover {
            background: rgba(75, 85, 99, 0.5);
            color: #F9FAFB;
            border-color: rgba(75, 85, 99, 0.7);
        }

        .btn-success {
            background: var(--secondary);
            color: white;
            cursor: pointer;
        }

        .btn-success:hover {
            background: #047857;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(5, 150, 105, 0.4);
        }

        .btn-success:active {
            transform: translateY(0);
        }

        /* Hero Section Buttons */
        .hero-btn {
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-primary-hero {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            color: white;
        }

        .btn-primary-hero:hover {
            background: linear-gradient(135deg, #4338CA 0%, #6D28D9 100%);
            box-shadow: 0 20px 40px -10px rgba(79, 70, 229, 0.5);
        }

        .btn-secondary-hero {
            background: linear-gradient(135deg, #059669 0%, #10B981 100%);
            color: white;
        }

        .btn-secondary-hero:hover {
            background: linear-gradient(135deg, #047857 0%, #059669 100%);
            box-shadow: 0 20px 40px -10px rgba(5, 150, 105, 0.5);
        }

        .btn-games-hero {
            background: linear-gradient(135deg, #8B5CF6 0%, #A78BFA 100%);
            color: white;
        }

        .btn-games-hero:hover {
            background: linear-gradient(135deg, #7C3AED 0%, #8B5CF6 100%);
            box-shadow: 0 20px 40px -10px rgba(139, 92, 246, 0.5);
        }
    </style>
</head>
<body>
<!-- Vanta.js Background -->
<div id="vanta-background"></div>

<div class="main-game-container">
    <!-- Header Navigation -->
    <nav class="bg-white shadow-sm px-4 py-4 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <a href="index.html" class="font-display text-2xl font-bold gradient-text hover:opacity-80 transition-opacity">Prompt Quest</a>
            </div>
            <div class="flex items-center space-x-6">
                <button class="open-achievements flex items-center gap-2 px-4 py-2 bg-yellow-100 rounded-lg hover:bg-yellow-200 transition-colors">
                    <span>üèÜ</span>
                    <span>Achievements</span>
                </button>
                <a href="learning.html" class="text-gray-600 hover:text-gray-900 font-medium">Learning</a>
                <a href="challenges.html" class="text-gray-600 hover:text-gray-900 font-medium">Challenges</a>
                <button onclick="document.body.classList.toggle('light-theme')" class="flex items-center justify-center w-10 h-10 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors" title="Toggle Theme">
                    <span>üåì</span>
                </button>
                <div class="relative">
                    <div id="streak-counter" class="flex items-center space-x-2 bg-orange-100 px-3 py-1 rounded-full">
                        <span class="text-orange-600">üî•</span>
                        <span class="font-semibold text-orange-700" id="current-streak">0</span>
                    </div>
                </div>
                <div id="user-display" class="flex items-center gap-3">
                    <!-- User info will be inserted here by Firebase -->
                </div>
                <div id="guest-upgrade-btn" class="hidden">
                    <a href="auth.html" class="flex items-center gap-2 px-3 py-1.5 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:opacity-90 transition-opacity text-sm font-medium">
                        <span>üîê</span>
                        <span>LOGIN/SIGN UP</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-bg relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-purple-600/20 to-green-600/20"></div>
        <div class="relative max-w-7xl mx-auto px-4 py-20 text-center">
            <h1 class="font-display text-5xl md:text-7xl font-bold mb-6 text-gray-900">
                <span id="typed-text"></span>
            </h1>
            <p class="text-xl md:text-2xl mb-12 text-gray-700 max-w-3xl mx-auto">
                Master the art of AI communication through interactive challenges, mini-games, and real-time feedback
            </p>
            <div class="flex flex-wrap gap-6 justify-center items-center max-w-4xl mx-auto">
                <a href="learning.html" class="hero-btn btn-primary-hero text-lg flex items-center gap-3 px-8 py-4 rounded-xl shadow-lg hover:shadow-2xl transition-all hover:-translate-y-1">
                    <span class="text-3xl">üìö</span>
                    <span class="font-semibold">Start Learning</span>
                </a>
                <a href="challenges.html" class="hero-btn btn-secondary-hero text-lg flex items-center gap-3 px-8 py-4 rounded-xl shadow-lg hover:shadow-2xl transition-all hover:-translate-y-1">
                    <span class="text-3xl">üéØ</span>
                    <span class="font-semibold">Start Challenges</span>
                </a>
                <button onclick="openMiniGamesHub()" class="hero-btn btn-games-hero text-lg flex items-center gap-3 px-8 py-4 rounded-xl shadow-lg hover:shadow-2xl transition-all hover:-translate-y-1">
                    <span class="text-3xl">üéÆ</span>
                    <span class="font-semibold">Play Mini-Games</span>
                </button>
            </div>

            <!-- Floating animation elements -->
            <div class="absolute top-10 left-10 text-4xl animate-float" style="animation-delay: 0s;">üí°</div>
            <div class="absolute top-20 right-20 text-4xl animate-float" style="animation-delay: 1s;">üöÄ</div>
            <div class="absolute bottom-10 left-1/4 text-4xl animate-float" style="animation-delay: 2s;">‚ú®</div>
        </div>
    </section>

    <!-- Quick Stats Section -->
    <section class="py-8 bg-white shadow-inner">
        <div class="max-w-7xl mx-auto px-4">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                <div class="stat-card">
                    <div class="text-3xl font-bold text-blue-600" id="total-prompts">0</div>
                    <div class="text-gray-600">Prompts Created</div>
                </div>
                <div class="stat-card">
                    <div class="text-3xl font-bold text-green-600" id="success-rate">0%</div>
                    <div class="text-gray-600">Success Rate</div>
                </div>
                <div class="stat-card">
                    <div class="text-3xl font-bold text-purple-600" id="achievements-unlocked">0</div>
                    <div class="text-gray-600">Achievements</div>
                </div>
                <div class="stat-card">
                    <div class="text-3xl font-bold text-orange-600" id="mini-games-played">0</div>
                    <div class="text-gray-600">Games Played</div>
                </div>
            </div>
        </div>
    </section>

</div>

<!-- Footer -->
<footer class="bg-black bg-opacity-50 backdrop-filter backdrop-blur-lg text-white py-12 px-4 mt-20 border-t border-gray-800">
    <div class="max-w-7xl mx-auto text-center">
        <div class="font-display text-2xl font-bold mb-4 gradient-text">Prompt Quest Enhanced</div>
        <p class="text-gray-400 mb-6">Master the art of AI communication through interactive learning</p>
        <div class="text-sm text-gray-500">
            ¬© 2025 Prompt Quest. Educational tool for AI literacy development.
        </div>
        <div class="text-xs text-gray-600 mt-2">
            Created by Mr Nascimento
        </div>
    </div>
</footer>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js"></script>

    <!-- Firebase Local Config (if exists, not committed to git) -->
    <script src="js/firebase-config.local.js" onerror="console.log('Local Firebase config not found, using defaults')"></script>
    <!-- Gemini Local Config (if exists, not committed to git) -->
    <script src="js/gemini-config.local.js" onerror="console.log('Local Gemini config not found, using defaults')"></script>
    
    
    <!-- Load scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/utils/storage-helper.js"></script>
    <script src="challenge-data.js"></script><script src="progress-system.js"></script>
<script src="gemini-integration.js"></script>
<script src="main.js"></script>

<!-- Core feature scripts -->
<script src="js/mini-games.js"></script>
<script src="js/achievements.js"></script>

<!-- Optional feature scripts -->
<script src="js/drag-drop-builder.js"></script>
<script src="js/ai-preview.js"></script>
<script src="js/multiplayer.js"></script>
<script src="js/audio-system.js"></script>
<script src="js/game-integration.js"></script>

<!-- Auth Check (Optional Mode) -->
<script>
    // Check authentication status but don't force login
    let isGuestMode = localStorage.getItem('guestMode') === 'true';
    let firebaseAvailable = typeof firebase !== 'undefined';

    // Define modal function FIRST before calling it
    function showModeSelectionModal() {
        const modal = document.createElement('div');
        modal.id = 'mode-selection-modal';
        modal.className = 'fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4';
        modal.innerHTML = `
                <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8 animate-scale-in">
                    <h2 class="text-4xl font-bold text-center mb-4 gradient-text">Welcome to Prompt Quest!</h2>
                    <p class="text-center text-gray-600 mb-8">Choose how you'd like to play</p>

                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Quick Play -->
                        <div class="border-2 border-gray-200 rounded-xl p-6 hover:border-purple-500 transition-all cursor-pointer" onclick="selectGuestMode()">
                            <div class="text-5xl text-center mb-4">‚ö°</div>
                            <h3 class="text-2xl font-bold text-center mb-3">Quick Play</h3>
                            <ul class="space-y-2 text-sm text-gray-600 mb-4">
                                <li class="flex items-start">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Play immediately, no sign-up</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Access all challenges</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-500 mr-2">‚úì</span>
                                    <span>Try mini-games</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-red-500 mr-2">‚úó</span>
                                    <span>Progress not saved</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-red-500 mr-2">‚úó</span>
                                    <span>No leaderboards</span>
                                </li>
                            </ul>
                            <button class="w-full bg-gray-600 text-white py-3 rounded-lg font-semibold hover:bg-gray-700 transition-colours" onclick="selectGuestMode(); event.stopPropagation();">
                                Play as Guest
                            </button>
                        </div>

                        <!-- Full Experience -->
                        <div class="border-2 border-indigo-500 rounded-xl p-6 bg-white cursor-pointer shadow-lg" onclick="selectAuthMode()">
                            <div class="text-5xl text-center mb-4">üèÜ</div>
                            <h3 class="text-2xl font-bold text-center mb-3 text-gray-900">Full Experience</h3>
                            <ul class="space-y-2 text-sm text-gray-900 mb-4 font-medium">
                                <li class="flex items-start">
                                    <span class="text-green-600 mr-2 font-bold">‚úì</span>
                                    <span>Save your progress</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-600 mr-2 font-bold">‚úì</span>
                                    <span>Unlock achievements</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-600 mr-2 font-bold">‚úì</span>
                                    <span>Compete on leaderboards</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-600 mr-2 font-bold">‚úì</span>
                                    <span>Track statistics</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-green-600 mr-2 font-bold">‚úì</span>
                                    <span>Multi-device sync</span>
                                </li>
                            </ul>
                            <button class="w-full bg-gradient-to-r from-indigo-600 to-emerald-600 text-white py-3 rounded-lg font-bold hover:from-indigo-700 hover:to-emerald-700 transition-all shadow-lg" onclick="selectAuthMode(); event.stopPropagation();">
                                Sign In / Register
                            </button>
                        </div>
                    </div>

                    <p class="text-center text-xs text-gray-500 mt-6">
                        You can always create an account later to save your progress
                    </p>
                </div>
            `;
        document.body.appendChild(modal);
    }

    function selectGuestMode() {
        localStorage.setItem('guestMode', 'true');
        sessionStorage.setItem('modeSelected', 'true');
        const modal = document.getElementById('mode-selection-modal');
        if (modal) modal.remove();
        window.location.reload();
    }

    function selectAuthMode() {
        sessionStorage.setItem('modeSelected', 'true');
        window.location.href = 'auth.html';
    }

    // Make functions globally available
    window.selectGuestMode = selectGuestMode;
    window.selectAuthMode = selectAuthMode;
    window.showModeSelectionModal = showModeSelectionModal;

    // Show modal immediately if no mode selected
    if (!isGuestMode && !sessionStorage.getItem('modeSelected')) {
        // Show modal immediately on page load
        setTimeout(() => {
            showModeSelectionModal();
        }, 100);
    }

    // Define showGuestModeBanner function early so it can be called immediately
    function showGuestModeBanner() {
        // Remove existing banner if any
        const existingBanner = document.querySelector('.guest-mode-banner');
        if (existingBanner) {
            existingBanner.remove();
        }

        // Show upgrade button in nav (more subtle than banner)
        const upgradeBtn = document.getElementById('guest-upgrade-btn');
        if (upgradeBtn) {
            upgradeBtn.classList.remove('hidden');
        }

        console.log('Guest mode banner displayed');
    }

    // Immediate check on page load
    if (isGuestMode) {
        console.log('Guest mode detected on page load');
        // Ensure game is visible immediately
        const mainGameContainer = document.querySelector('.main-game-container');
        if (mainGameContainer) {
            mainGameContainer.classList.remove('hidden');
        }
        // Hide auth container if exists
        const authContainer = document.getElementById('auth-container');
        if (authContainer) {
            authContainer.classList.add('hidden');
        }
        // Hide auth-only elements in guest mode
        document.querySelectorAll('.auth-only').forEach(el => {
            el.style.display = 'none';
        });
        // Show banner immediately if in guest mode
        setTimeout(() => {
            if (!document.querySelector('.guest-mode-banner')) {
                showGuestModeBanner();
            }
        }, 100);
    }

    // Wait for Firebase to load
    setTimeout(() => {
        // Check guest mode first
        isGuestMode = localStorage.getItem('guestMode') === 'true';
        console.log('Guest mode status:', isGuestMode);

        if (firebaseAvailable && firebase.apps && firebase.apps.length > 0) {
            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    // User is authenticated - enable full features
                    isGuestMode = false;
                    localStorage.removeItem('guestMode');
                    console.log('Authenticated user:', user.email);
                    // Hide guest banner if shown
                    document.querySelector('.fixed.top-0')?.remove();
                } else if (!isGuestMode) {
                    // Not authenticated and not in guest mode - show mode selection
                    // Always show on home page (index.html)
                    showModeSelectionModal();
                } else {
                    // Guest mode - limited features
                    console.log('Playing in Guest Mode');
                    showGuestModeBanner();
                    // Ensure game is visible in guest mode
                    const mainGameContainer = document.querySelector('.main-game-container');
                    if (mainGameContainer) {
                        mainGameContainer.classList.remove('hidden');
                    }
                    // Remove any auth container
                    const authContainer = document.getElementById('auth-container');
                    if (authContainer) {
                        authContainer.classList.add('hidden');
                    }
                    // Hide auth-only elements in guest mode
                    document.querySelectorAll('.auth-only').forEach(el => {
                        el.style.display = 'none';
                    });
                }
            });
        } else {
            // Firebase not configured - auto guest mode
            console.log('Firebase not configured - running in local-only mode');
            if (!isGuestMode) {
                localStorage.setItem('guestMode', 'true');
                isGuestMode = true;
            }
            // Ensure game is visible
            const mainGameContainer = document.querySelector('.main-game-container');
            if (mainGameContainer) {
                mainGameContainer.classList.remove('hidden');
            }
            // Hide auth container if exists
            const authContainer = document.getElementById('auth-container');
            if (authContainer) {
                authContainer.classList.add('hidden');
            }
            showLocalOnlyBanner();
        }
    }, 500);

    // selectGuestMode and selectAuthMode already defined above

    function oldSelectGuestMode() {
        localStorage.setItem('guestMode', 'true');
        sessionStorage.setItem('modeSelected', 'true');
        console.log('Guest mode selected');

        // Remove modal
        const modal = document.getElementById('mode-selection-modal');
        if (modal) {
            modal.remove();
        }

        // Ensure game container is visible
        const mainGameContainer = document.querySelector('.main-game-container');
        if (mainGameContainer) {
            mainGameContainer.classList.remove('hidden');
        }

        // Hide any auth container
        const authContainer = document.getElementById('auth-container');
        if (authContainer) {
            authContainer.classList.add('hidden');
        }

        // Show banner
        showGuestModeBanner();

        // Reload page to apply guest mode
        setTimeout(() => {
            window.location.reload();
        }, 300);
    }

    function selectAuthMode() {
        sessionStorage.setItem('modeSelected', 'true');
        window.location.href = 'auth.html';
    }

    // Make functions globally available
    window.selectGuestMode = selectGuestMode;
    window.selectAuthMode = selectAuthMode;

    function showLocalOnlyBanner() {
        const banner = document.createElement('div');
        banner.className = 'fixed top-0 left-0 right-0 bg-gradient-to-r from-blue-500 to-indigo-500 text-white py-2 px-4 z-40 text-center text-sm';
        banner.innerHTML = `
                <span>üíæ Local Mode - Progress saved on this device only</span>
                <a href="FIREBASE_SETUP.md" target="_blank" class="ml-4 bg-white text-blue-600 px-3 py-1 rounded font-semibold hover:bg-gray-100 transition-colours">
                    Enable Cloud Sync
                </a>
                <button onclick="this.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">‚úï</button>
            `;
        document.body.insertBefore(banner, document.body.firstChild);
    }
</script>

<script>
    // Initialize typed text effect
    document.addEventListener('DOMContentLoaded', function() {
        new Typed('#typed-text', {
            strings: [
                'Write better AI prompts',
                'Get more accurate responses',
                'Master prompt engineering',
                'Level up your AI skills',
                'Unlock achievements',
                'Play mini-games',
                'Build prompts visually'
            ],
            typeSpeed: 50,
            backSpeed: 30,
            backDelay: 2000,
            loop: true,
            showCursor: true,
            cursorChar: '|'
        });

        // Update stats
        updateDashboardStats();

        // Periodic stat updates
        setInterval(updateDashboardStats, 5000);

        // Initialize Vanta.js background - try NET effect for modern look
        if (window.VANTA) {
            try {
                window.vantaEffect = VANTA.NET({
                    el: "#vanta-background",
                    mouseControls: true,
                    touchControls: true,
                    gyroControls: false,
                    minHeight: 200.00,
                    minWidth: 200.00,
                    scale: 1.00,
                    scaleMobile: 1.00,
                    color: 0x4F46E5,  // Primary color
                    backgroundColor: 0x0F0F1E, // Dark background
                    points: 10.00,
                    maxDistance: 20.00,
                    spacing: 18.00,
                    showDots: true
                });
            } catch (e) {
                console.log('Vanta NET failed, trying DOTS...');
                try {
                    window.vantaEffect = VANTA.DOTS({
                        el: "#vanta-background",
                        mouseControls: true,
                        touchControls: true,
                        gyroControls: false,
                        minHeight: 200.00,
                        minWidth: 200.00,
                        scale: 1.00,
                        scaleMobile: 1.00,
                        color: 0x4F46E5,
                        color2: 0x059669,
                        backgroundColor: 0x0F0F1E,
                        size: 3.00,
                        spacing: 35.00,
                        showLines: false
                    });
                } catch (e2) {
                    console.log('Vanta effects failed, using CSS fallback');
                    // Fallback to animated CSS background
                    document.getElementById('vanta-background').className = 'animated-bg';
                }
            }
        }
    });

    // Open mini-games hub
    function openMiniGamesHub() {
        if (window.promptMiniGames) {
            window.promptMiniGames.openGameHub();
        } else {
            // Fallback if mini-games not loaded yet
            setTimeout(() => {
                if (window.promptMiniGames) {
                    window.promptMiniGames.openGameHub();
                }
            }, 500);
        }
    }

    // Update dashboard statistics
    function updateDashboardStats() {
        const stats = {
            totalPrompts: localStorage.getItem('totalPrompts') || 0,
            successRate: localStorage.getItem('successRate') || 0,
            achievements: window.achievementSystem?.getUnlockedCount() || 0,
            gamesPlayed: localStorage.getItem('miniGamesPlayed') || 0
        };

        document.getElementById('total-prompts').textContent = stats.totalPrompts;
        document.getElementById('success-rate').textContent = stats.successRate + '%';
        document.getElementById('achievements-unlocked').textContent = stats.achievements;
        document.getElementById('mini-games-played').textContent = stats.gamesPlayed;

        // Update streak
        const streak = localStorage.getItem('currentStreak') || 0;
        document.getElementById('current-streak').textContent = streak;
    }

    // Add particle effects on achievements
    window.addEventListener('achievementUnlocked', (e) => {
        createParticleExplosion(window.innerWidth / 2, window.innerHeight / 2);
    });

    function createParticleExplosion(x, y) {
        for (let i = 0; i < 30; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.setProperty('--x-offset', (Math.random() - 0.5) * 200 + 'px');
            particle.innerHTML = ['‚ú®', '‚≠ê', 'üí´', 'üåü'][Math.floor(Math.random() * 4)];
            document.body.appendChild(particle);
        }
    }
</script>
</body>
</html>